using CeraDevices;
using CeraDevices.Coordinator2;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;

namespace StreetLightPanel
{
    /// <summary>
    /// App.xaml 的互動邏輯
    /// </summary>
    public partial class App : Application
    {
       // public CeraDevices.CoordinatorDevice dev;
        public CeraDevices.DeviceManager coor_mgr;
        public StreetLightInfo[] street_light_info;
        public bool IsStart = true;
        public static string[,] Light2DInfo = new string[,] {
#region 綠創新
        {  "1",	"2766",	"610"},
{"2",	"2334",	"611"},
{"3",	"1929",	"607"},
{"4",	"1524",	"607"},
{"5",	"987",	"692"},
{"6",	"757",	"381"},
{"7",	"526",	"650"},
{"8",	"659",	"913"},
{ "9",	"813",	"1169"},
{"10",	"1070",	"1291"},
{"11",	"1319",	"1292"},
{"12",	"1646",	"1291"},
{"13",	"2036",	"1290"},
{"14",	"2325",	"1289"},
{"15",	"2749",	"1275"},
{"16",	"2773",	"1055"}
    


#endregion

#region 法鼓山

// {  "1","1479","925"},
//{"2","1343","1103"},
//{"3","1181","1243"},
//{"4","1885","945"},
//{"5","1653","1203"},
//{"6","1505","1379"},
//{"7","2023","1297"},
//{"8","1775","1466"},
//{"9","2377","1328"},
//{"10","2089","1482"},
//{"11","2939","1296"},
//{"12","2335","1936"},
//{"13","2299","1730"},
//{"14","3217","335"}
#endregion
#region 台北大學
//{"1","1473","218"},  {"2","1492","220"},
//{"3","1495","247"},  {"4","1513","251"},
//{"5","1517","277"},  {"6","1533","280"},
//{"7","1534","303"},  {"8","1553","309"},
//{"9","1556","335"},  {"10","1575","338"},
//{"11","1576","363"},  {"12","1595","369"},
//{"13","1597","393"},  {"14","1616","396"},
//{"15","1615","418"},  {"16","1634","421"},
//{"17","1632","446"},  {"18","1655","450"},
//{"19","1674","502"},  {"20","1679","485"},
//{"21","1700","537"},  {"22","1697","512"},
//{"23","1720","566"},  {"24","1712","531"},
//{"25","1737","600"},  {"26","1741","574"},
//{"27","1718","612"},  {"28","1754","603"},
//{"29","1674","637"},  {"30","1734","616"},
//{"31","1641","659"},  {"32","1702","636"},
//{"33","1615","677"},  {"34","1665","659"},
//{"35","1589","694"},  {"36","1635","679"},
//{"37","1554","716"},  {"38","1609","695"},
//{"39","1522","734"},  {"40","1576","717"},
//{"41","1495","752"},  {"42","1545","738"},
//{"43","1465","767"},  {"44","1516","755"},
//{"45","1438","785"},  {"46","1488","772"},
//{"47","1412","802"},  {"48","1460","790"},
//{"49","1382","817"},  {"50","1430","808"},
//{"51","1357","834"},  {"52","1407","823"},
//{"53","1330","859"},  {"54","1377","842"},
//{"55","1304","877"},  {"56","1350","860"},
//{"57","1275","897"},  {"58","1325","878"},
//{"59","1239","920"},  {"60","1298","898"},
//{"61","1207","938"},  {"62","1265","919"},
//{"63","1176","954"},  {"64","1231","940"},
//{"65","1152","970"},  {"66","1196","958"},
//{"67","1123","993"},  {"68","1168","973"},
//{"69","1104","1026"},  {"70","1143","990"},
//{"71","1096","1054"},  {"72","1119","1020"},
//{"73","1087","1089"},  {"74","1111","1041"},
//{"75","1074","1125"},  {"76","1107","1058"},
//{"77","1059","1157"},  {"78","1097","1094"},
//{"79","1039","1180"},  {"80","1076","1155"},
//{"81","1014","1202"},  {"82","1059","1180"},
//{"83","985","1214"},  {"84","1037","1201"},
//{"85","958","1218"},  {"86","1004","1218"},
//{"87","922","1211"},  {"88","967","1229"},
//{"89","893","1205"},  {"90","938","1231"},
//{"91","866","1202"},  {"92","904","1222"},
//{"93","840","1204"},  {"94","879","1216"},
//{"95","802","1209"},  {"96","854","1217"},
//{"97","768","1217"},  {"98","818","1221"},
//{"99","730","1225"},  {"100","782","1228"},
//{"101","692","1229"},  {"102","748","1235"},
//{"103","659","1232"},  {"104","714","1239"},
//{"105","558","957"},  {"106","666","1246"},
//{"107","575","957"},  {"108","574","936"},
//{"109","592","935"},  {"110","595","909"},
//{"111","627","894"},  {"112","624","875"},
//{"113","645","870"},  {"114","644","850"},
//{"115","668","846"},  {"116","667","824"},
//{"117","690","821"},  {"118","695","799"},
//{"119","718","800"},  {"120","720","778"},
//{"121","745","777"},  {"122","747","758"},
//{"123","771","754"},  {"124","771","735"},
//{"125","790","730"},  {"126","787","708"},
//{"127","808","703"},  {"128","835","657"},
//{"129","833","678"},  {"130","858","653"},
//{"131","882","629"},  {"132","881","610"},
//{"133","904","609"},  {"134","923","589"},
//{"135","947","569"},  {"136","926","566"},
//{"137","969","547"},  {"138","946","547"},
//{"139","990","525"},  {"140","968","526"},
//{"141","1014","502"},  {"142","992","502"},
//{"143","1036","481"},  {"144","1014","481"},
//{"145","1060","462"},  {"146","1040","459"},
//{"147","1081","445"},  {"148","1062","440"},
//{"149","1109","424"},  {"150","1085","420"},
//{"151","1135","406"},  {"152","1110","403"},
//{"153","1165","385"},  {"154","1140","381"},
//{"155","1199","361"},  {"156","1202","337"},
//{"157","1228","339"},  {"158","1260","295"},
//{"159","1255","322"},  {"160","1286","300"},
//{"161","1317","279"},  {"162","1330","251"},
//{"163","1353","257"},  {"164","1366","239"},
//{"165","1392","246"},  {"166","1405","225"},
//{"167","1441","221"},  {"168","1469","187"},


#endregion
    };


        public App()
        {
#if Version1
            coor_mgr = new DeviceManager(new ICoordinatorDevice[] { new CoordinatorDevice("http://10.10.1.1:8080") });
#else
            coor_mgr =new DeviceManager(new ICoordinatorDevice[]{ new CoordinatorDevice2("http://10.10.2.1:8080")});
#endif
            #region 綠創園區
          //  coor_mgr = new DeviceManager(new CeraDevices.CoordinatorDevice[] { new CeraDevices.CoordinatorDevice("http://172.16.23.92:8080") });
            #endregion

            try
            {
#if !DEBUG
                AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
                street_light_info = coor_mgr.GetStreetLightList();

#endif
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message + "," + ex.StackTrace);
                Environment.Exit(-1);
            }
        }

        void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
        {
            System.IO.StreamWriter wr =
                new System.IO.StreamWriter(AppDomain.CurrentDomain.BaseDirectory + "unhandleerr.log");

            Exception ex=(Exception) e.ExceptionObject ;
            wr.WriteLine(ex.Message + "," + ex.StackTrace);
        }
    }
}
